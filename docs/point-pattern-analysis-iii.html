<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Point Pattern Analysis III | An Introduction to Spatial Data Analysis and Statistics: A Course in R</title>
  <meta name="description" content="This book was created as a resource for teaching applied spatial statistics at McMaster University by Antonio Paez, with support from Anastassios Dardas, Rajveer Ubhi, Megan Coad and Alexis Polidoro. Further testing and refinements are due to John Merrall and Anastasia Soukhov. The book is published with support of an Open Educational Resources grant from MacPherson Institute, McMaster University." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Point Pattern Analysis III | An Introduction to Spatial Data Analysis and Statistics: A Course in R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.jpg" />
  <meta property="og:description" content="This book was created as a resource for teaching applied spatial statistics at McMaster University by Antonio Paez, with support from Anastassios Dardas, Rajveer Ubhi, Megan Coad and Alexis Polidoro. Further testing and refinements are due to John Merrall and Anastasia Soukhov. The book is published with support of an Open Educational Resources grant from MacPherson Institute, McMaster University." />
  <meta name="github-repo" content="paezha/spatial-analysis-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Point Pattern Analysis III | An Introduction to Spatial Data Analysis and Statistics: A Course in R" />
  
  <meta name="twitter:description" content="This book was created as a resource for teaching applied spatial statistics at McMaster University by Antonio Paez, with support from Anastassios Dardas, Rajveer Ubhi, Megan Coad and Alexis Polidoro. Further testing and refinements are due to John Merrall and Anastasia Soukhov. The book is published with support of an Open Educational Resources grant from MacPherson Institute, McMaster University." />
  <meta name="twitter:image" content="/images/cover.jpg" />

<meta name="author" content="Antonio Paez" />


<meta name="date" content="2024-02-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="activity-5-point-pattern-analysis-ii.html"/>
<link rel="next" href="activity-6-point-pattern-analysis-iii.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.0/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<script src="libs/lfx-heat-0.1.0/lfx-heat-prod.js"></script>
<script src="libs/lfx-heat-0.1.0/lfx-heat-bindings.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/colourpicker-1.1/colourpicker.min.css" rel="stylesheet" />
<script src="libs/colourpicker-1.1/colourpicker.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-grid-3.4.1/bootstrap-grid.min.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="front-matter.html"><a href="front-matter.html"><i class="fa fa-check"></i>Front Matter</a>
<ul>
<li class="chapter" data-level="" data-path="front-matter.html"><a href="front-matter.html#what-is-this-book-and-who-is-it-for"><i class="fa fa-check"></i>What is this book and who is it for?</a></li>
<li class="chapter" data-level="" data-path="front-matter.html"><a href="front-matter.html#allied-resources"><i class="fa fa-check"></i>Allied resources</a></li>
<li class="chapter" data-level="" data-path="front-matter.html"><a href="front-matter.html#contributing"><i class="fa fa-check"></i>Contributing</a>
<ul>
<li class="chapter" data-level="0.0.1" data-path="front-matter.html"><a href="front-matter.html#license"><i class="fa fa-check"></i><b>0.0.1</b> License</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#spatial-analysis-and-spatial-statistics"><i class="fa fa-check"></i>Spatial Analysis and Spatial Statistics</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#why-this-text"><i class="fa fa-check"></i>Why this Text?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#plan"><i class="fa fa-check"></i>Plan</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#audience"><i class="fa fa-check"></i>Audience</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#requisites"><i class="fa fa-check"></i>Requisites</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#words-of-appreciation"><i class="fa fa-check"></i>Words of Appreciation</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#versioning"><i class="fa fa-check"></i>Versioning</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i-getting-to-know-the-technology.html"><a href="part-i-getting-to-know-the-technology.html"><i class="fa fa-check"></i>PART I: Getting to know the technology</a></li>
<li class="chapter" data-level="1" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>1</b> Preliminaries: Installing <code>R</code> and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="preliminaries.html"><a href="preliminaries.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="preliminaries.html"><a href="preliminaries.html#learning-objectives"><i class="fa fa-check"></i><b>1.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.3" data-path="preliminaries.html"><a href="preliminaries.html#r-the-open-statistical-computing-project"><i class="fa fa-check"></i><b>1.3</b> <code>R</code>: The Open Statistical Computing Project</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="preliminaries.html"><a href="preliminaries.html#what-is-r"><i class="fa fa-check"></i><b>1.3.1</b> What is <code>R</code>?</a></li>
<li class="chapter" data-level="1.3.2" data-path="preliminaries.html"><a href="preliminaries.html#the-rstudio-ide"><i class="fa fa-check"></i><b>1.3.2</b> The RStudio IDE</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="preliminaries.html"><a href="preliminaries.html#packages-in-r"><i class="fa fa-check"></i><b>1.4</b> Packages in R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-operations.html"><a href="basic-operations.html"><i class="fa fa-check"></i><b>2</b> Basic Operations and Data Structures in <code>R</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-operations.html"><a href="basic-operations.html#learning-objectives-1"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="basic-operations.html"><a href="basic-operations.html#rstudio-ide"><i class="fa fa-check"></i><b>2.2</b> RStudio IDE</a></li>
<li class="chapter" data-level="2.3" data-path="basic-operations.html"><a href="basic-operations.html#some-basic-operations"><i class="fa fa-check"></i><b>2.3</b> Some Basic Operations</a></li>
<li class="chapter" data-level="2.4" data-path="basic-operations.html"><a href="basic-operations.html#data-classes-in-r"><i class="fa fa-check"></i><b>2.4</b> Data Classes in R</a></li>
<li class="chapter" data-level="2.5" data-path="basic-operations.html"><a href="basic-operations.html#data-types-in-r"><i class="fa fa-check"></i><b>2.5</b> Data Types in R</a></li>
<li class="chapter" data-level="2.6" data-path="basic-operations.html"><a href="basic-operations.html#indexing-and-data-transformations"><i class="fa fa-check"></i><b>2.6</b> Indexing and Data Transformations</a></li>
<li class="chapter" data-level="2.7" data-path="basic-operations.html"><a href="basic-operations.html#visualization"><i class="fa fa-check"></i><b>2.7</b> Visualization</a></li>
<li class="chapter" data-level="2.8" data-path="basic-operations.html"><a href="basic-operations.html#creating-a-simple-map"><i class="fa fa-check"></i><b>2.8</b> Creating a Simple Map</a></li>
<li class="chapter" data-level="2.9" data-path="basic-operations.html"><a href="basic-operations.html#examples-of-digital-cartography-in-r"><i class="fa fa-check"></i><b>2.9</b> Examples of digital cartography in <code>R</code></a></li>
<li class="chapter" data-level="2.10" data-path="basic-operations.html"><a href="basic-operations.html#references"><i class="fa fa-check"></i><b>2.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii-statistics-and-maps.html"><a href="part-ii-statistics-and-maps.html"><i class="fa fa-check"></i>Part II: Statistics and Maps</a></li>
<li class="chapter" data-level="3" data-path="introduction-to-maps.html"><a href="introduction-to-maps.html"><i class="fa fa-check"></i><b>3</b> Introduction to Mapping in <code>R</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-maps.html"><a href="introduction-to-maps.html#learning-objectives-2"><i class="fa fa-check"></i><b>3.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-maps.html"><a href="introduction-to-maps.html#suggested-readings"><i class="fa fa-check"></i><b>3.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-maps.html"><a href="introduction-to-maps.html#preliminaries-1"><i class="fa fa-check"></i><b>3.3</b> Preliminaries</a></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-maps.html"><a href="introduction-to-maps.html#packages"><i class="fa fa-check"></i><b>3.4</b> Packages</a></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-maps.html"><a href="introduction-to-maps.html#exploring-dataframes-and-a-simple-proportional-symbols-map"><i class="fa fa-check"></i><b>3.5</b> Exploring Dataframes and a Simple Proportional Symbols Map</a></li>
<li class="chapter" data-level="3.6" data-path="introduction-to-maps.html"><a href="introduction-to-maps.html#improving-on-the-proportional-symbols-map"><i class="fa fa-check"></i><b>3.6</b> Improving on the Proportional Symbols Map</a></li>
<li class="chapter" data-level="3.7" data-path="introduction-to-maps.html"><a href="introduction-to-maps.html#some-simple-spatial-analysis"><i class="fa fa-check"></i><b>3.7</b> Some Simple Spatial Analysis</a></li>
<li class="chapter" data-level="3.8" data-path="introduction-to-maps.html"><a href="introduction-to-maps.html#other-resources"><i class="fa fa-check"></i><b>3.8</b> Other Resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="activity-statistical-maps-i.html"><a href="activity-statistical-maps-i.html"><i class="fa fa-check"></i><b>4</b> Activity: Statistical Maps I</a>
<ul>
<li class="chapter" data-level="4.1" data-path="activity-statistical-maps-i.html"><a href="activity-statistical-maps-i.html#housekeeping-questions"><i class="fa fa-check"></i><b>4.1</b> Housekeeping Questions</a></li>
<li class="chapter" data-level="4.2" data-path="activity-statistical-maps-i.html"><a href="activity-statistical-maps-i.html#learning-objectives-3"><i class="fa fa-check"></i><b>4.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="4.3" data-path="activity-statistical-maps-i.html"><a href="activity-statistical-maps-i.html#preliminaries-2"><i class="fa fa-check"></i><b>4.3</b> Preliminaries</a></li>
<li class="chapter" data-level="4.4" data-path="activity-statistical-maps-i.html"><a href="activity-statistical-maps-i.html#creating-a-simple-thematic-map"><i class="fa fa-check"></i><b>4.4</b> Creating a simple thematic map</a></li>
<li class="chapter" data-level="4.5" data-path="activity-statistical-maps-i.html"><a href="activity-statistical-maps-i.html#activity"><i class="fa fa-check"></i><b>4.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mapping-continued.html"><a href="mapping-continued.html"><i class="fa fa-check"></i><b>5</b> Mapping in R: Continued</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mapping-continued.html"><a href="mapping-continued.html#learning-objectives-4"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="mapping-continued.html"><a href="mapping-continued.html#suggested-readings-1"><i class="fa fa-check"></i><b>5.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="5.3" data-path="mapping-continued.html"><a href="mapping-continued.html#preliminaries-3"><i class="fa fa-check"></i><b>5.3</b> Preliminaries</a></li>
<li class="chapter" data-level="5.4" data-path="mapping-continued.html"><a href="mapping-continued.html#summarizing-a-dataframe"><i class="fa fa-check"></i><b>5.4</b> Summarizing a Dataframe</a></li>
<li class="chapter" data-level="5.5" data-path="mapping-continued.html"><a href="mapping-continued.html#factors"><i class="fa fa-check"></i><b>5.5</b> Factors</a></li>
<li class="chapter" data-level="5.6" data-path="mapping-continued.html"><a href="mapping-continued.html#subsetting-data"><i class="fa fa-check"></i><b>5.6</b> Subsetting Data</a></li>
<li class="chapter" data-level="5.7" data-path="mapping-continued.html"><a href="mapping-continued.html#pipe-operator"><i class="fa fa-check"></i><b>5.7</b> Pipe Operator</a></li>
<li class="chapter" data-level="5.8" data-path="mapping-continued.html"><a href="mapping-continued.html#more-on-visualization"><i class="fa fa-check"></i><b>5.8</b> More on Visualization</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="activity-2-statistical-maps-ii.html"><a href="activity-2-statistical-maps-ii.html"><i class="fa fa-check"></i><b>6</b> Activity 2: Statistical Maps II</a>
<ul>
<li class="chapter" data-level="6.1" data-path="activity-2-statistical-maps-ii.html"><a href="activity-2-statistical-maps-ii.html#housekeeping-questions-1"><i class="fa fa-check"></i><b>6.1</b> Housekeeping Questions</a></li>
<li class="chapter" data-level="6.2" data-path="activity-2-statistical-maps-ii.html"><a href="activity-2-statistical-maps-ii.html#learning-objectives-5"><i class="fa fa-check"></i><b>6.2</b> Learning objectives</a></li>
<li class="chapter" data-level="6.3" data-path="activity-2-statistical-maps-ii.html"><a href="activity-2-statistical-maps-ii.html#suggested-reading"><i class="fa fa-check"></i><b>6.3</b> Suggested reading</a></li>
<li class="chapter" data-level="6.4" data-path="activity-2-statistical-maps-ii.html"><a href="activity-2-statistical-maps-ii.html#preliminaries-4"><i class="fa fa-check"></i><b>6.4</b> Preliminaries</a></li>
<li class="chapter" data-level="6.5" data-path="activity-2-statistical-maps-ii.html"><a href="activity-2-statistical-maps-ii.html#activity-1"><i class="fa fa-check"></i><b>6.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="maps-as-processes.html"><a href="maps-as-processes.html"><i class="fa fa-check"></i><b>7</b> Maps as Processes: Null Landscapes, Spatial Processes, and Statistical Maps</a>
<ul>
<li class="chapter" data-level="7.1" data-path="maps-as-processes.html"><a href="maps-as-processes.html#learning-objectives-6"><i class="fa fa-check"></i><b>7.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.2" data-path="maps-as-processes.html"><a href="maps-as-processes.html#suggested-readings-2"><i class="fa fa-check"></i><b>7.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="7.3" data-path="maps-as-processes.html"><a href="maps-as-processes.html#preliminaries-5"><i class="fa fa-check"></i><b>7.3</b> Preliminaries</a></li>
<li class="chapter" data-level="7.4" data-path="maps-as-processes.html"><a href="maps-as-processes.html#random-numbers"><i class="fa fa-check"></i><b>7.4</b> Random Numbers</a></li>
<li class="chapter" data-level="7.5" data-path="maps-as-processes.html"><a href="maps-as-processes.html#null-landscapes"><i class="fa fa-check"></i><b>7.5</b> Null Landscapes</a></li>
<li class="chapter" data-level="7.6" data-path="maps-as-processes.html"><a href="maps-as-processes.html#stochastic-processes"><i class="fa fa-check"></i><b>7.6</b> Stochastic Processes</a></li>
<li class="chapter" data-level="7.7" data-path="maps-as-processes.html"><a href="maps-as-processes.html#simulating-spatial-processes"><i class="fa fa-check"></i><b>7.7</b> Simulating Spatial Processes</a></li>
<li class="chapter" data-level="7.8" data-path="maps-as-processes.html"><a href="maps-as-processes.html#processes-and-patterns"><i class="fa fa-check"></i><b>7.8</b> Processes and Patterns</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="activity-3-maps-as-processes.html"><a href="activity-3-maps-as-processes.html"><i class="fa fa-check"></i><b>8</b> Activity 3: Maps as Processes</a>
<ul>
<li class="chapter" data-level="8.1" data-path="activity-3-maps-as-processes.html"><a href="activity-3-maps-as-processes.html#practice-questions"><i class="fa fa-check"></i><b>8.1</b> Practice Questions</a></li>
<li class="chapter" data-level="8.2" data-path="activity-3-maps-as-processes.html"><a href="activity-3-maps-as-processes.html#learning-objectives-7"><i class="fa fa-check"></i><b>8.2</b> Learning Objectives</a></li>
<li class="chapter" data-level="8.3" data-path="activity-3-maps-as-processes.html"><a href="activity-3-maps-as-processes.html#suggested-reading-1"><i class="fa fa-check"></i><b>8.3</b> Suggested Reading</a></li>
<li class="chapter" data-level="8.4" data-path="activity-3-maps-as-processes.html"><a href="activity-3-maps-as-processes.html#preliminaries-6"><i class="fa fa-check"></i><b>8.4</b> Preliminaries</a></li>
<li class="chapter" data-level="8.5" data-path="activity-3-maps-as-processes.html"><a href="activity-3-maps-as-processes.html#activity-2"><i class="fa fa-check"></i><b>8.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii-analysis-of-point-patterns.html"><a href="part-iii-analysis-of-point-patterns.html"><i class="fa fa-check"></i>Part III: Analysis of Point Patterns</a></li>
<li class="chapter" data-level="9" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html"><i class="fa fa-check"></i><b>9</b> Point Pattern Analysis I</a>
<ul>
<li class="chapter" data-level="9.1" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#learning-objectives-8"><i class="fa fa-check"></i><b>9.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="9.2" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#suggested-readings-3"><i class="fa fa-check"></i><b>9.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="9.3" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#preliminaries-7"><i class="fa fa-check"></i><b>9.3</b> Preliminaries</a></li>
<li class="chapter" data-level="9.4" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#point-patterns"><i class="fa fa-check"></i><b>9.4</b> Point Patterns</a></li>
<li class="chapter" data-level="9.5" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#processes-and-point-patterns"><i class="fa fa-check"></i><b>9.5</b> Processes and Point Patterns</a></li>
<li class="chapter" data-level="9.6" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#intensity-and-density"><i class="fa fa-check"></i><b>9.6</b> Intensity and Density</a></li>
<li class="chapter" data-level="9.7" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#quadrats-and-density-maps"><i class="fa fa-check"></i><b>9.7</b> Quadrats and Density Maps</a></li>
<li class="chapter" data-level="9.8" data-path="point-pattern-analysis-i.html"><a href="point-pattern-analysis-i.html#defining-the-region-for-analysis"><i class="fa fa-check"></i><b>9.8</b> Defining the Region for Analysis</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="activity-4-point-pattern-analysis-i.html"><a href="activity-4-point-pattern-analysis-i.html"><i class="fa fa-check"></i><b>10</b> Activity 4: Point Pattern Analysis I</a>
<ul>
<li class="chapter" data-level="10.1" data-path="activity-4-point-pattern-analysis-i.html"><a href="activity-4-point-pattern-analysis-i.html#practice-questions-1"><i class="fa fa-check"></i><b>10.1</b> Practice questions</a></li>
<li class="chapter" data-level="10.2" data-path="activity-4-point-pattern-analysis-i.html"><a href="activity-4-point-pattern-analysis-i.html#learning-objectives-9"><i class="fa fa-check"></i><b>10.2</b> Learning objectives</a></li>
<li class="chapter" data-level="10.3" data-path="activity-4-point-pattern-analysis-i.html"><a href="activity-4-point-pattern-analysis-i.html#suggested-reading-2"><i class="fa fa-check"></i><b>10.3</b> Suggested reading</a></li>
<li class="chapter" data-level="10.4" data-path="activity-4-point-pattern-analysis-i.html"><a href="activity-4-point-pattern-analysis-i.html#preliminaries-8"><i class="fa fa-check"></i><b>10.4</b> Preliminaries</a></li>
<li class="chapter" data-level="10.5" data-path="activity-4-point-pattern-analysis-i.html"><a href="activity-4-point-pattern-analysis-i.html#activity-3"><i class="fa fa-check"></i><b>10.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="point-patern-analysis-ii.html"><a href="point-patern-analysis-ii.html"><i class="fa fa-check"></i><b>11</b> Point Pattern Analysis II</a>
<ul>
<li class="chapter" data-level="11.1" data-path="point-patern-analysis-ii.html"><a href="point-patern-analysis-ii.html#learning-objectives-10"><i class="fa fa-check"></i><b>11.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="point-patern-analysis-ii.html"><a href="point-patern-analysis-ii.html#suggested-readings-4"><i class="fa fa-check"></i><b>11.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="11.3" data-path="point-patern-analysis-ii.html"><a href="point-patern-analysis-ii.html#preliminaries-9"><i class="fa fa-check"></i><b>11.3</b> Preliminaries</a></li>
<li class="chapter" data-level="11.4" data-path="point-patern-analysis-ii.html"><a href="point-patern-analysis-ii.html#a-quadrat-based-test-for-spatial-independence"><i class="fa fa-check"></i><b>11.4</b> A Quadrat-based Test for Spatial Independence</a></li>
<li class="chapter" data-level="11.5" data-path="point-patern-analysis-ii.html"><a href="point-patern-analysis-ii.html#limitations-of-quadrat-analysis-size-and-number-of-quadrats"><i class="fa fa-check"></i><b>11.5</b> Limitations of Quadrat Analysis: Size and Number of Quadrats</a></li>
<li class="chapter" data-level="11.6" data-path="point-patern-analysis-ii.html"><a href="point-patern-analysis-ii.html#limitations-of-quadrat-analysis-relative-position-of-events"><i class="fa fa-check"></i><b>11.6</b> Limitations of Quadrat Analysis: Relative Position of Events</a></li>
<li class="chapter" data-level="11.7" data-path="point-patern-analysis-ii.html"><a href="point-patern-analysis-ii.html#kernel-density"><i class="fa fa-check"></i><b>11.7</b> Kernel Density</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="activity-5-point-pattern-analysis-ii.html"><a href="activity-5-point-pattern-analysis-ii.html"><i class="fa fa-check"></i><b>12</b> Activity 5: Point Pattern Analysis II</a>
<ul>
<li class="chapter" data-level="12.1" data-path="activity-5-point-pattern-analysis-ii.html"><a href="activity-5-point-pattern-analysis-ii.html#practice-questions-2"><i class="fa fa-check"></i><b>12.1</b> Practice questions</a></li>
<li class="chapter" data-level="12.2" data-path="activity-5-point-pattern-analysis-ii.html"><a href="activity-5-point-pattern-analysis-ii.html#learning-objectives-11"><i class="fa fa-check"></i><b>12.2</b> Learning objectives</a></li>
<li class="chapter" data-level="12.3" data-path="activity-5-point-pattern-analysis-ii.html"><a href="activity-5-point-pattern-analysis-ii.html#suggested-reading-3"><i class="fa fa-check"></i><b>12.3</b> Suggested reading</a></li>
<li class="chapter" data-level="12.4" data-path="activity-5-point-pattern-analysis-ii.html"><a href="activity-5-point-pattern-analysis-ii.html#preliminaries-10"><i class="fa fa-check"></i><b>12.4</b> Preliminaries</a></li>
<li class="chapter" data-level="12.5" data-path="activity-5-point-pattern-analysis-ii.html"><a href="activity-5-point-pattern-analysis-ii.html#activity-4"><i class="fa fa-check"></i><b>12.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html"><i class="fa fa-check"></i><b>13</b> Point Pattern Analysis III</a>
<ul>
<li class="chapter" data-level="13.1" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#learning-objectives-12"><i class="fa fa-check"></i><b>13.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="13.2" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#suggested-readings-5"><i class="fa fa-check"></i><b>13.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="13.3" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#preliminaries-11"><i class="fa fa-check"></i><b>13.3</b> Preliminaries</a></li>
<li class="chapter" data-level="13.4" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#motivation"><i class="fa fa-check"></i><b>13.4</b> Motivation</a></li>
<li class="chapter" data-level="13.5" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#nearest-neighbors"><i class="fa fa-check"></i><b>13.5</b> Nearest Neighbors</a></li>
<li class="chapter" data-level="13.6" data-path="point-pattern-analysis-iii.html"><a href="point-pattern-analysis-iii.html#g-function"><i class="fa fa-check"></i><b>13.6</b> <span class="math inline">\(G\)</span>-function</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="activity-6-point-pattern-analysis-iii.html"><a href="activity-6-point-pattern-analysis-iii.html"><i class="fa fa-check"></i><b>14</b> Activity 6: Point Pattern Analysis III</a>
<ul>
<li class="chapter" data-level="14.1" data-path="activity-6-point-pattern-analysis-iii.html"><a href="activity-6-point-pattern-analysis-iii.html#practice-questions-3"><i class="fa fa-check"></i><b>14.1</b> Practice questions</a></li>
<li class="chapter" data-level="14.2" data-path="activity-6-point-pattern-analysis-iii.html"><a href="activity-6-point-pattern-analysis-iii.html#learning-objectives-13"><i class="fa fa-check"></i><b>14.2</b> Learning objectives</a></li>
<li class="chapter" data-level="14.3" data-path="activity-6-point-pattern-analysis-iii.html"><a href="activity-6-point-pattern-analysis-iii.html#suggested-reading-4"><i class="fa fa-check"></i><b>14.3</b> Suggested reading</a></li>
<li class="chapter" data-level="14.4" data-path="activity-6-point-pattern-analysis-iii.html"><a href="activity-6-point-pattern-analysis-iii.html#preliminaries-12"><i class="fa fa-check"></i><b>14.4</b> Preliminaries</a></li>
<li class="chapter" data-level="14.5" data-path="activity-6-point-pattern-analysis-iii.html"><a href="activity-6-point-pattern-analysis-iii.html#activity-5"><i class="fa fa-check"></i><b>14.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html"><i class="fa fa-check"></i><b>15</b> Point Pattern Analysis IV</a>
<ul>
<li class="chapter" data-level="15.1" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#learning-objectives-14"><i class="fa fa-check"></i><b>15.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="15.2" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#suggested-readings-6"><i class="fa fa-check"></i><b>15.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="15.3" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#preliminaries-13"><i class="fa fa-check"></i><b>15.3</b> Preliminaries</a></li>
<li class="chapter" data-level="15.4" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#motivation-1"><i class="fa fa-check"></i><b>15.4</b> Motivation</a></li>
<li class="chapter" data-level="15.5" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#f-function"><i class="fa fa-check"></i><b>15.5</b> F-function</a></li>
<li class="chapter" data-level="15.6" data-path="point-pattern-analysis-iv.html"><a href="point-pattern-analysis-iv.html#hatk-function"><i class="fa fa-check"></i><b>15.6</b> <span class="math inline">\(\hat{K}\)</span>-function</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="activity-7-point-pattern-analysis-iv.html"><a href="activity-7-point-pattern-analysis-iv.html"><i class="fa fa-check"></i><b>16</b> Activity 7: Point Pattern Analysis IV</a>
<ul>
<li class="chapter" data-level="16.1" data-path="activity-7-point-pattern-analysis-iv.html"><a href="activity-7-point-pattern-analysis-iv.html#practice-questions-4"><i class="fa fa-check"></i><b>16.1</b> Practice questions</a></li>
<li class="chapter" data-level="16.2" data-path="activity-7-point-pattern-analysis-iv.html"><a href="activity-7-point-pattern-analysis-iv.html#learning-objectives-15"><i class="fa fa-check"></i><b>16.2</b> Learning objectives</a></li>
<li class="chapter" data-level="16.3" data-path="activity-7-point-pattern-analysis-iv.html"><a href="activity-7-point-pattern-analysis-iv.html#suggested-reading-5"><i class="fa fa-check"></i><b>16.3</b> Suggested reading</a></li>
<li class="chapter" data-level="16.4" data-path="activity-7-point-pattern-analysis-iv.html"><a href="activity-7-point-pattern-analysis-iv.html#preliminaries-14"><i class="fa fa-check"></i><b>16.4</b> Preliminaries</a></li>
<li class="chapter" data-level="16.5" data-path="activity-7-point-pattern-analysis-iv.html"><a href="activity-7-point-pattern-analysis-iv.html#activity-6"><i class="fa fa-check"></i><b>16.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html"><i class="fa fa-check"></i><b>17</b> Point Pattern Analysis V</a>
<ul>
<li class="chapter" data-level="17.1" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#learning-objectives-16"><i class="fa fa-check"></i><b>17.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="17.2" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#suggested-readings-7"><i class="fa fa-check"></i><b>17.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="17.3" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#preliminaries-15"><i class="fa fa-check"></i><b>17.3</b> Preliminaries</a></li>
<li class="chapter" data-level="17.4" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#motivation-hypothesis-testing"><i class="fa fa-check"></i><b>17.4</b> Motivation: Hypothesis Testing</a></li>
<li class="chapter" data-level="17.5" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#null-landscapes-revisited"><i class="fa fa-check"></i><b>17.5</b> Null Landscapes Revisited</a></li>
<li class="chapter" data-level="17.6" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#simulation-envelopes"><i class="fa fa-check"></i><b>17.6</b> Simulation Envelopes</a></li>
<li class="chapter" data-level="17.7" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#things-to-keep-in-mind"><i class="fa fa-check"></i><b>17.7</b> Things to Keep in Mind!</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#definition-of-a-region"><i class="fa fa-check"></i><b>17.7.1</b> Definition of a Region</a></li>
<li class="chapter" data-level="17.7.2" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#edge-effects"><i class="fa fa-check"></i><b>17.7.2</b> Edge Effects</a></li>
<li class="chapter" data-level="17.7.3" data-path="point-pattern-analysis-v.html"><a href="point-pattern-analysis-v.html#sampled-point-patterns"><i class="fa fa-check"></i><b>17.7.3</b> Sampled Point Patterns</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="activity-8-point-pattern-analysis-v.html"><a href="activity-8-point-pattern-analysis-v.html"><i class="fa fa-check"></i><b>18</b> Activity 8: Point Pattern Analysis V</a>
<ul>
<li class="chapter" data-level="18.1" data-path="activity-8-point-pattern-analysis-v.html"><a href="activity-8-point-pattern-analysis-v.html#practice-questions-5"><i class="fa fa-check"></i><b>18.1</b> Practice questions</a></li>
<li class="chapter" data-level="18.2" data-path="activity-8-point-pattern-analysis-v.html"><a href="activity-8-point-pattern-analysis-v.html#learning-objectives-17"><i class="fa fa-check"></i><b>18.2</b> Learning objectives</a></li>
<li class="chapter" data-level="18.3" data-path="activity-8-point-pattern-analysis-v.html"><a href="activity-8-point-pattern-analysis-v.html#suggested-reading-6"><i class="fa fa-check"></i><b>18.3</b> Suggested reading</a></li>
<li class="chapter" data-level="18.4" data-path="activity-8-point-pattern-analysis-v.html"><a href="activity-8-point-pattern-analysis-v.html#preliminaries-16"><i class="fa fa-check"></i><b>18.4</b> Preliminaries</a></li>
<li class="chapter" data-level="18.5" data-path="activity-8-point-pattern-analysis-v.html"><a href="activity-8-point-pattern-analysis-v.html#activity-7"><i class="fa fa-check"></i><b>18.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iv-data-in-areal-units.html"><a href="part-iv-data-in-areal-units.html"><i class="fa fa-check"></i>Part IV: Data in Areal Units</a></li>
<li class="chapter" data-level="19" data-path="area-data-i.html"><a href="area-data-i.html"><i class="fa fa-check"></i><b>19</b> Area Data I</a>
<ul>
<li class="chapter" data-level="19.1" data-path="area-data-i.html"><a href="area-data-i.html#learning-objectives-18"><i class="fa fa-check"></i><b>19.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="19.2" data-path="area-data-i.html"><a href="area-data-i.html#suggested-readings-8"><i class="fa fa-check"></i><b>19.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="19.3" data-path="area-data-i.html"><a href="area-data-i.html#preliminaries-17"><i class="fa fa-check"></i><b>19.3</b> Preliminaries</a></li>
<li class="chapter" data-level="19.4" data-path="area-data-i.html"><a href="area-data-i.html#area-data"><i class="fa fa-check"></i><b>19.4</b> Area Data</a></li>
<li class="chapter" data-level="19.5" data-path="area-data-i.html"><a href="area-data-i.html#processes-and-area-data"><i class="fa fa-check"></i><b>19.5</b> Processes and Area Data</a></li>
<li class="chapter" data-level="19.6" data-path="area-data-i.html"><a href="area-data-i.html#visualizing-area-data-choropleth-maps"><i class="fa fa-check"></i><b>19.6</b> Visualizing Area Data: Choropleth Maps</a></li>
<li class="chapter" data-level="19.7" data-path="area-data-i.html"><a href="area-data-i.html#visualizing-area-data-cartograms"><i class="fa fa-check"></i><b>19.7</b> Visualizing Area Data: Cartograms</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="activity-9-area-data-i.html"><a href="activity-9-area-data-i.html"><i class="fa fa-check"></i><b>20</b> Activity 9: Area Data I</a>
<ul>
<li class="chapter" data-level="20.1" data-path="activity-9-area-data-i.html"><a href="activity-9-area-data-i.html#practice-questions-6"><i class="fa fa-check"></i><b>20.1</b> Practice questions</a></li>
<li class="chapter" data-level="20.2" data-path="activity-9-area-data-i.html"><a href="activity-9-area-data-i.html#learning-objectives-19"><i class="fa fa-check"></i><b>20.2</b> Learning objectives</a></li>
<li class="chapter" data-level="20.3" data-path="activity-9-area-data-i.html"><a href="activity-9-area-data-i.html#suggested-reading-7"><i class="fa fa-check"></i><b>20.3</b> Suggested reading</a></li>
<li class="chapter" data-level="20.4" data-path="activity-9-area-data-i.html"><a href="activity-9-area-data-i.html#preliminaries-18"><i class="fa fa-check"></i><b>20.4</b> Preliminaries</a></li>
<li class="chapter" data-level="20.5" data-path="activity-9-area-data-i.html"><a href="activity-9-area-data-i.html#activity-8"><i class="fa fa-check"></i><b>20.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="area-data-ii.html"><a href="area-data-ii.html"><i class="fa fa-check"></i><b>21</b> Area Data II</a>
<ul>
<li class="chapter" data-level="21.1" data-path="area-data-ii.html"><a href="area-data-ii.html#learning-objectives-20"><i class="fa fa-check"></i><b>21.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="21.2" data-path="area-data-ii.html"><a href="area-data-ii.html#suggested-readings-9"><i class="fa fa-check"></i><b>21.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="21.3" data-path="area-data-ii.html"><a href="area-data-ii.html#preliminaries-19"><i class="fa fa-check"></i><b>21.3</b> Preliminaries</a></li>
<li class="chapter" data-level="21.4" data-path="area-data-ii.html"><a href="area-data-ii.html#proximity-in-area-data"><i class="fa fa-check"></i><b>21.4</b> Proximity in Area Data</a></li>
<li class="chapter" data-level="21.5" data-path="area-data-ii.html"><a href="area-data-ii.html#spatial-weights-matrices"><i class="fa fa-check"></i><b>21.5</b> Spatial Weights Matrices</a></li>
<li class="chapter" data-level="21.6" data-path="area-data-ii.html"><a href="area-data-ii.html#creating-spatial-weights-matrices-in-r"><i class="fa fa-check"></i><b>21.6</b> Creating Spatial Weights Matrices in <code>R</code></a></li>
<li class="chapter" data-level="21.7" data-path="area-data-ii.html"><a href="area-data-ii.html#spatial-moving-averages"><i class="fa fa-check"></i><b>21.7</b> Spatial Moving Averages</a></li>
<li class="chapter" data-level="21.8" data-path="area-data-ii.html"><a href="area-data-ii.html#other-criteria-for-coding-proximity"><i class="fa fa-check"></i><b>21.8</b> Other Criteria for Coding Proximity</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="activity-10-area-data-ii.html"><a href="activity-10-area-data-ii.html"><i class="fa fa-check"></i><b>22</b> Activity 10: Area Data II</a>
<ul>
<li class="chapter" data-level="22.1" data-path="activity-10-area-data-ii.html"><a href="activity-10-area-data-ii.html#practice-questions-7"><i class="fa fa-check"></i><b>22.1</b> Practice questions</a></li>
<li class="chapter" data-level="22.2" data-path="activity-10-area-data-ii.html"><a href="activity-10-area-data-ii.html#learning-objectives-21"><i class="fa fa-check"></i><b>22.2</b> Learning objectives</a></li>
<li class="chapter" data-level="22.3" data-path="activity-10-area-data-ii.html"><a href="activity-10-area-data-ii.html#suggested-reading-8"><i class="fa fa-check"></i><b>22.3</b> Suggested reading</a></li>
<li class="chapter" data-level="22.4" data-path="activity-10-area-data-ii.html"><a href="activity-10-area-data-ii.html#preliminaries-20"><i class="fa fa-check"></i><b>22.4</b> Preliminaries</a></li>
<li class="chapter" data-level="22.5" data-path="activity-10-area-data-ii.html"><a href="activity-10-area-data-ii.html#activity-9"><i class="fa fa-check"></i><b>22.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="area-data-iii.html"><a href="area-data-iii.html"><i class="fa fa-check"></i><b>23</b> Area Data III</a>
<ul>
<li class="chapter" data-level="23.1" data-path="area-data-iii.html"><a href="area-data-iii.html#learning-objectives-22"><i class="fa fa-check"></i><b>23.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="23.2" data-path="area-data-iii.html"><a href="area-data-iii.html#suggested-readings-10"><i class="fa fa-check"></i><b>23.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="23.3" data-path="area-data-iii.html"><a href="area-data-iii.html#preliminaries-21"><i class="fa fa-check"></i><b>23.3</b> Preliminaries</a></li>
<li class="chapter" data-level="23.4" data-path="area-data-iii.html"><a href="area-data-iii.html#spatial-moving-averages-and-simulation"><i class="fa fa-check"></i><b>23.4</b> Spatial Moving Averages and Simulation</a></li>
<li class="chapter" data-level="23.5" data-path="area-data-iii.html"><a href="area-data-iii.html#the-spatial-moving-average-as-a-smoother"><i class="fa fa-check"></i><b>23.5</b> The Spatial Moving Average as a Smoother</a></li>
<li class="chapter" data-level="23.6" data-path="area-data-iii.html"><a href="area-data-iii.html#spatial-moving-average-scatterplots"><i class="fa fa-check"></i><b>23.6</b> Spatial Moving Average Scatterplots</a></li>
<li class="chapter" data-level="23.7" data-path="area-data-iii.html"><a href="area-data-iii.html#spatial-autocorrelation-and-morans-i-coefficient"><i class="fa fa-check"></i><b>23.7</b> Spatial Autocorrelation and Moran’s <span class="math inline">\(I\)</span> coefficient</a></li>
<li class="chapter" data-level="23.8" data-path="area-data-iii.html"><a href="area-data-iii.html#morans-i-and-morans-scatterplot"><i class="fa fa-check"></i><b>23.8</b> Moran’s <span class="math inline">\(I\)</span> and Moran’s Scatterplot</a></li>
<li class="chapter" data-level="23.9" data-path="area-data-iii.html"><a href="area-data-iii.html#hypothesis-testing-for-spatial-autocorrelation"><i class="fa fa-check"></i><b>23.9</b> Hypothesis Testing for Spatial Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="activity-11-area-data-iii.html"><a href="activity-11-area-data-iii.html"><i class="fa fa-check"></i><b>24</b> Activity 11: Area Data III</a>
<ul>
<li class="chapter" data-level="24.1" data-path="activity-11-area-data-iii.html"><a href="activity-11-area-data-iii.html#practice-questions-8"><i class="fa fa-check"></i><b>24.1</b> Practice questions</a></li>
<li class="chapter" data-level="24.2" data-path="activity-11-area-data-iii.html"><a href="activity-11-area-data-iii.html#learning-objectives-23"><i class="fa fa-check"></i><b>24.2</b> Learning objectives</a></li>
<li class="chapter" data-level="24.3" data-path="activity-11-area-data-iii.html"><a href="activity-11-area-data-iii.html#suggested-reading-9"><i class="fa fa-check"></i><b>24.3</b> Suggested reading</a></li>
<li class="chapter" data-level="24.4" data-path="activity-11-area-data-iii.html"><a href="activity-11-area-data-iii.html#preliminaries-22"><i class="fa fa-check"></i><b>24.4</b> Preliminaries</a></li>
<li class="chapter" data-level="24.5" data-path="activity-11-area-data-iii.html"><a href="activity-11-area-data-iii.html#activity-10"><i class="fa fa-check"></i><b>24.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="area-data-iv.html"><a href="area-data-iv.html"><i class="fa fa-check"></i><b>25</b> Area Data IV</a>
<ul>
<li class="chapter" data-level="25.1" data-path="area-data-iv.html"><a href="area-data-iv.html#learning-objectives-24"><i class="fa fa-check"></i><b>25.1</b> Learning objectives</a></li>
<li class="chapter" data-level="25.2" data-path="area-data-iv.html"><a href="area-data-iv.html#suggested-readings-11"><i class="fa fa-check"></i><b>25.2</b> Suggested readings</a></li>
<li class="chapter" data-level="25.3" data-path="area-data-iv.html"><a href="area-data-iv.html#preliminaries-23"><i class="fa fa-check"></i><b>25.3</b> Preliminaries</a></li>
<li class="chapter" data-level="25.4" data-path="area-data-iv.html"><a href="area-data-iv.html#decomposing-morans-i"><i class="fa fa-check"></i><b>25.4</b> Decomposing Moran’s <span class="math inline">\(I\)</span></a></li>
<li class="chapter" data-level="25.5" data-path="area-data-iv.html"><a href="area-data-iv.html#local-morans-i-and-mapping"><i class="fa fa-check"></i><b>25.5</b> Local Moran’s <span class="math inline">\(I\)</span> and Mapping</a></li>
<li class="chapter" data-level="25.6" data-path="area-data-iv.html"><a href="area-data-iv.html#a-quick-note-on-functions"><i class="fa fa-check"></i><b>25.6</b> A Quick Note on Functions</a></li>
<li class="chapter" data-level="25.7" data-path="area-data-iv.html"><a href="area-data-iv.html#a-concentration-approach-for-local-analysis-of-spatial-association"><i class="fa fa-check"></i><b>25.7</b> A Concentration approach for Local Analysis of Spatial Association</a></li>
<li class="chapter" data-level="25.8" data-path="area-data-iv.html"><a href="area-data-iv.html#a-short-note-on-hypothesis-testing"><i class="fa fa-check"></i><b>25.8</b> A Short Note on Hypothesis Testing</a></li>
<li class="chapter" data-level="25.9" data-path="area-data-iv.html"><a href="area-data-iv.html#detection-of-hot-and-cold-spots"><i class="fa fa-check"></i><b>25.9</b> Detection of Hot and Cold Spots</a></li>
<li class="chapter" data-level="25.10" data-path="area-data-iv.html"><a href="area-data-iv.html#other-resources-1"><i class="fa fa-check"></i><b>25.10</b> Other Resources</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="activity-12-area-data-iv.html"><a href="activity-12-area-data-iv.html"><i class="fa fa-check"></i><b>26</b> Activity 12: Area Data IV</a>
<ul>
<li class="chapter" data-level="26.1" data-path="activity-12-area-data-iv.html"><a href="activity-12-area-data-iv.html#practice-questions-9"><i class="fa fa-check"></i><b>26.1</b> Practice questions</a></li>
<li class="chapter" data-level="26.2" data-path="activity-12-area-data-iv.html"><a href="activity-12-area-data-iv.html#learning-objectives-25"><i class="fa fa-check"></i><b>26.2</b> Learning objectives</a></li>
<li class="chapter" data-level="26.3" data-path="activity-12-area-data-iv.html"><a href="activity-12-area-data-iv.html#suggested-reading-10"><i class="fa fa-check"></i><b>26.3</b> Suggested reading</a></li>
<li class="chapter" data-level="26.4" data-path="activity-12-area-data-iv.html"><a href="activity-12-area-data-iv.html#preliminaries-24"><i class="fa fa-check"></i><b>26.4</b> Preliminaries</a></li>
<li class="chapter" data-level="26.5" data-path="activity-12-area-data-iv.html"><a href="activity-12-area-data-iv.html#activity-11"><i class="fa fa-check"></i><b>26.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="area-data-v.html"><a href="area-data-v.html"><i class="fa fa-check"></i><b>27</b> Area Data V</a>
<ul>
<li class="chapter" data-level="27.1" data-path="area-data-v.html"><a href="area-data-v.html#learning-objectives-26"><i class="fa fa-check"></i><b>27.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="27.2" data-path="area-data-v.html"><a href="area-data-v.html#suggested-readings-12"><i class="fa fa-check"></i><b>27.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="27.3" data-path="area-data-v.html"><a href="area-data-v.html#preliminaries-25"><i class="fa fa-check"></i><b>27.3</b> Preliminaries</a></li>
<li class="chapter" data-level="27.4" data-path="area-data-v.html"><a href="area-data-v.html#regression-analysis-in-r"><i class="fa fa-check"></i><b>27.4</b> Regression Analysis in <code>R</code></a></li>
<li class="chapter" data-level="27.5" data-path="area-data-v.html"><a href="area-data-v.html#autocorrelation-as-a-model-diagnostic"><i class="fa fa-check"></i><b>27.5</b> Autocorrelation as a Model Diagnostic</a></li>
<li class="chapter" data-level="27.6" data-path="area-data-v.html"><a href="area-data-v.html#variable-transformations"><i class="fa fa-check"></i><b>27.6</b> Variable Transformations</a></li>
<li class="chapter" data-level="27.7" data-path="area-data-v.html"><a href="area-data-v.html#a-note-about-spatial-autocorrelation-in-regression-analysis"><i class="fa fa-check"></i><b>27.7</b> A Note about Spatial Autocorrelation in Regression Analysis</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="activity-13-area-data-v.html"><a href="activity-13-area-data-v.html"><i class="fa fa-check"></i><b>28</b> Activity 13: Area Data V</a>
<ul>
<li class="chapter" data-level="28.1" data-path="activity-13-area-data-v.html"><a href="activity-13-area-data-v.html#practice-questions-10"><i class="fa fa-check"></i><b>28.1</b> Practice questions</a></li>
<li class="chapter" data-level="28.2" data-path="activity-13-area-data-v.html"><a href="activity-13-area-data-v.html#learning-objectives-27"><i class="fa fa-check"></i><b>28.2</b> Learning objectives</a></li>
<li class="chapter" data-level="28.3" data-path="activity-13-area-data-v.html"><a href="activity-13-area-data-v.html#suggested-reading-11"><i class="fa fa-check"></i><b>28.3</b> Suggested reading</a></li>
<li class="chapter" data-level="28.4" data-path="activity-13-area-data-v.html"><a href="activity-13-area-data-v.html#preliminaries-26"><i class="fa fa-check"></i><b>28.4</b> Preliminaries</a></li>
<li class="chapter" data-level="28.5" data-path="activity-13-area-data-v.html"><a href="activity-13-area-data-v.html#activity-12"><i class="fa fa-check"></i><b>28.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="area-data-vi.html"><a href="area-data-vi.html"><i class="fa fa-check"></i><b>29</b> Area Data VI</a>
<ul>
<li class="chapter" data-level="29.1" data-path="area-data-vi.html"><a href="area-data-vi.html#learning-objectives-28"><i class="fa fa-check"></i><b>29.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="29.2" data-path="area-data-vi.html"><a href="area-data-vi.html#suggested-readings-13"><i class="fa fa-check"></i><b>29.2</b> Suggested Readings</a></li>
<li class="chapter" data-level="29.3" data-path="area-data-vi.html"><a href="area-data-vi.html#preliminaries-27"><i class="fa fa-check"></i><b>29.3</b> Preliminaries</a></li>
<li class="chapter" data-level="29.4" data-path="area-data-vi.html"><a href="area-data-vi.html#residual-spatial-autocorrelation-revisited"><i class="fa fa-check"></i><b>29.4</b> Residual spatial autocorrelation revisited</a>
<ul>
<li class="chapter" data-level="29.4.1" data-path="area-data-vi.html"><a href="area-data-vi.html#incorrect-functional-form"><i class="fa fa-check"></i><b>29.4.1</b> Incorrect Functional Form</a></li>
<li class="chapter" data-level="29.4.2" data-path="area-data-vi.html"><a href="area-data-vi.html#omitted-variables"><i class="fa fa-check"></i><b>29.4.2</b> Omitted Variables</a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="area-data-vi.html"><a href="area-data-vi.html#remedial-action"><i class="fa fa-check"></i><b>29.5</b> Remedial Action</a></li>
<li class="chapter" data-level="29.6" data-path="area-data-vi.html"><a href="area-data-vi.html#flexible-functional-forms-and-models-with-spatially-varying-coefficients"><i class="fa fa-check"></i><b>29.6</b> Flexible Functional Forms and Models with Spatially-varying Coefficients</a>
<ul>
<li class="chapter" data-level="29.6.1" data-path="area-data-vi.html"><a href="area-data-vi.html#trend-surface-analysis"><i class="fa fa-check"></i><b>29.6.1</b> Trend Surface Analysis</a></li>
<li class="chapter" data-level="29.6.2" data-path="area-data-vi.html"><a href="area-data-vi.html#models-with-spatially-varying-coefficients"><i class="fa fa-check"></i><b>29.6.2</b> Models with Spatially-varying Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="29.7" data-path="area-data-vi.html"><a href="area-data-vi.html#spatial-error-model-sem"><i class="fa fa-check"></i><b>29.7</b> Spatial Error Model (SEM)</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="activity-14-area-data-vi.html"><a href="activity-14-area-data-vi.html"><i class="fa fa-check"></i><b>30</b> Activity 14: Area Data VI</a>
<ul>
<li class="chapter" data-level="30.1" data-path="activity-14-area-data-vi.html"><a href="activity-14-area-data-vi.html#practice-questions-11"><i class="fa fa-check"></i><b>30.1</b> Practice questions</a></li>
<li class="chapter" data-level="30.2" data-path="activity-14-area-data-vi.html"><a href="activity-14-area-data-vi.html#learning-objectives-29"><i class="fa fa-check"></i><b>30.2</b> Learning objectives</a></li>
<li class="chapter" data-level="30.3" data-path="activity-14-area-data-vi.html"><a href="activity-14-area-data-vi.html#suggested-reading-12"><i class="fa fa-check"></i><b>30.3</b> Suggested reading</a></li>
<li class="chapter" data-level="30.4" data-path="activity-14-area-data-vi.html"><a href="activity-14-area-data-vi.html#preliminaries-28"><i class="fa fa-check"></i><b>30.4</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="30.4.1" data-path="activity-14-area-data-vi.html"><a href="activity-14-area-data-vi.html#new-york-leukemia-data"><i class="fa fa-check"></i><b>30.4.1</b> New York leukemia data</a></li>
<li class="chapter" data-level="30.4.2" data-path="activity-14-area-data-vi.html"><a href="activity-14-area-data-vi.html#pennsylvania-lung-cancer"><i class="fa fa-check"></i><b>30.4.2</b> Pennsylvania lung cancer</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="activity-14-area-data-vi.html"><a href="activity-14-area-data-vi.html#activity-13"><i class="fa fa-check"></i><b>30.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-v-analysis-and-prediction-of-fields.html"><a href="part-v-analysis-and-prediction-of-fields.html"><i class="fa fa-check"></i>Part V: Analysis and Prediction of Fields</a></li>
<li class="chapter" data-level="31" data-path="spatially-continuous-data-i.html"><a href="spatially-continuous-data-i.html"><i class="fa fa-check"></i><b>31</b> Spatially Continuous Data I</a>
<ul>
<li class="chapter" data-level="31.1" data-path="spatially-continuous-data-i.html"><a href="spatially-continuous-data-i.html#learning-objectives-30"><i class="fa fa-check"></i><b>31.1</b> Learning objectives</a></li>
<li class="chapter" data-level="31.2" data-path="spatially-continuous-data-i.html"><a href="spatially-continuous-data-i.html#suggested-readings-14"><i class="fa fa-check"></i><b>31.2</b> Suggested readings</a></li>
<li class="chapter" data-level="31.3" data-path="spatially-continuous-data-i.html"><a href="spatially-continuous-data-i.html#preliminaries-29"><i class="fa fa-check"></i><b>31.3</b> Preliminaries</a></li>
<li class="chapter" data-level="31.4" data-path="spatially-continuous-data-i.html"><a href="spatially-continuous-data-i.html#spatially-continuous-field-data"><i class="fa fa-check"></i><b>31.4</b> Spatially continuous (field) data</a></li>
<li class="chapter" data-level="31.5" data-path="spatially-continuous-data-i.html"><a href="spatially-continuous-data-i.html#exploratory-visualization"><i class="fa fa-check"></i><b>31.5</b> Exploratory visualization</a></li>
<li class="chapter" data-level="31.6" data-path="spatially-continuous-data-i.html"><a href="spatially-continuous-data-i.html#tile-based-methods"><i class="fa fa-check"></i><b>31.6</b> Tile-based methods</a></li>
<li class="chapter" data-level="31.7" data-path="spatially-continuous-data-i.html"><a href="spatially-continuous-data-i.html#inverse-distance-weighting-idw"><i class="fa fa-check"></i><b>31.7</b> Inverse distance weighting (IDW)</a></li>
<li class="chapter" data-level="31.8" data-path="spatially-continuous-data-i.html"><a href="spatially-continuous-data-i.html#k-point-means"><i class="fa fa-check"></i><b>31.8</b> <span class="math inline">\(k\)</span>-point means</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="activity-15-spatially-continuous-data-i.html"><a href="activity-15-spatially-continuous-data-i.html"><i class="fa fa-check"></i><b>32</b> Activity 15: Spatially Continuous Data I</a>
<ul>
<li class="chapter" data-level="32.1" data-path="activity-15-spatially-continuous-data-i.html"><a href="activity-15-spatially-continuous-data-i.html#practice-questions-12"><i class="fa fa-check"></i><b>32.1</b> Practice questions</a></li>
<li class="chapter" data-level="32.2" data-path="activity-15-spatially-continuous-data-i.html"><a href="activity-15-spatially-continuous-data-i.html#learning-objectives-31"><i class="fa fa-check"></i><b>32.2</b> Learning objectives</a></li>
<li class="chapter" data-level="32.3" data-path="activity-15-spatially-continuous-data-i.html"><a href="activity-15-spatially-continuous-data-i.html#suggested-reading-13"><i class="fa fa-check"></i><b>32.3</b> Suggested reading</a></li>
<li class="chapter" data-level="32.4" data-path="activity-15-spatially-continuous-data-i.html"><a href="activity-15-spatially-continuous-data-i.html#preliminaries-30"><i class="fa fa-check"></i><b>32.4</b> Preliminaries</a></li>
<li class="chapter" data-level="32.5" data-path="activity-15-spatially-continuous-data-i.html"><a href="activity-15-spatially-continuous-data-i.html#activity-14"><i class="fa fa-check"></i><b>32.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="spatially-continuous-data-ii.html"><a href="spatially-continuous-data-ii.html"><i class="fa fa-check"></i><b>33</b> Spatially Continuous Data II</a>
<ul>
<li class="chapter" data-level="33.1" data-path="spatially-continuous-data-ii.html"><a href="spatially-continuous-data-ii.html#learning-objectives-32"><i class="fa fa-check"></i><b>33.1</b> Learning objectives</a></li>
<li class="chapter" data-level="33.2" data-path="spatially-continuous-data-ii.html"><a href="spatially-continuous-data-ii.html#suggested-readings-15"><i class="fa fa-check"></i><b>33.2</b> Suggested readings</a></li>
<li class="chapter" data-level="33.3" data-path="spatially-continuous-data-ii.html"><a href="spatially-continuous-data-ii.html#preliminaries-31"><i class="fa fa-check"></i><b>33.3</b> Preliminaries</a></li>
<li class="chapter" data-level="33.4" data-path="spatially-continuous-data-ii.html"><a href="spatially-continuous-data-ii.html#uncertainty-in-the-predictions"><i class="fa fa-check"></i><b>33.4</b> Uncertainty in the predictions</a></li>
<li class="chapter" data-level="33.5" data-path="spatially-continuous-data-ii.html"><a href="spatially-continuous-data-ii.html#trend-surface-analysis-1"><i class="fa fa-check"></i><b>33.5</b> Trend surface analysis</a></li>
<li class="chapter" data-level="33.6" data-path="spatially-continuous-data-ii.html"><a href="spatially-continuous-data-ii.html#accuracy-and-precision"><i class="fa fa-check"></i><b>33.6</b> Accuracy and precision</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="activity-16-spatially-continuous-data-ii.html"><a href="activity-16-spatially-continuous-data-ii.html"><i class="fa fa-check"></i><b>34</b> Activity 16: Spatially Continuous Data II</a>
<ul>
<li class="chapter" data-level="34.1" data-path="activity-16-spatially-continuous-data-ii.html"><a href="activity-16-spatially-continuous-data-ii.html#practice-questions-13"><i class="fa fa-check"></i><b>34.1</b> Practice questions</a></li>
<li class="chapter" data-level="34.2" data-path="activity-16-spatially-continuous-data-ii.html"><a href="activity-16-spatially-continuous-data-ii.html#learning-objectives-33"><i class="fa fa-check"></i><b>34.2</b> Learning objectives</a></li>
<li class="chapter" data-level="34.3" data-path="activity-16-spatially-continuous-data-ii.html"><a href="activity-16-spatially-continuous-data-ii.html#suggested-reading-14"><i class="fa fa-check"></i><b>34.3</b> Suggested reading</a></li>
<li class="chapter" data-level="34.4" data-path="activity-16-spatially-continuous-data-ii.html"><a href="activity-16-spatially-continuous-data-ii.html#preliminaries-32"><i class="fa fa-check"></i><b>34.4</b> Preliminaries</a></li>
<li class="chapter" data-level="34.5" data-path="activity-16-spatially-continuous-data-ii.html"><a href="activity-16-spatially-continuous-data-ii.html#activity-15"><i class="fa fa-check"></i><b>34.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="spatially-continuous-data-iii.html"><a href="spatially-continuous-data-iii.html"><i class="fa fa-check"></i><b>35</b> Spatially Continuous Data III</a>
<ul>
<li class="chapter" data-level="35.1" data-path="spatially-continuous-data-iii.html"><a href="spatially-continuous-data-iii.html#learning-objectives-34"><i class="fa fa-check"></i><b>35.1</b> Learning objectives</a></li>
<li class="chapter" data-level="35.2" data-path="spatially-continuous-data-iii.html"><a href="spatially-continuous-data-iii.html#suggested-reading-15"><i class="fa fa-check"></i><b>35.2</b> Suggested reading</a></li>
<li class="chapter" data-level="35.3" data-path="spatially-continuous-data-iii.html"><a href="spatially-continuous-data-iii.html#preliminaries-33"><i class="fa fa-check"></i><b>35.3</b> Preliminaries</a></li>
<li class="chapter" data-level="35.4" data-path="spatially-continuous-data-iii.html"><a href="spatially-continuous-data-iii.html#residual-spatial-pattern"><i class="fa fa-check"></i><b>35.4</b> Residual spatial pattern</a></li>
<li class="chapter" data-level="35.5" data-path="spatially-continuous-data-iii.html"><a href="spatially-continuous-data-iii.html#measuring-spatial-dependence-in-spatially-continuous-data"><i class="fa fa-check"></i><b>35.5</b> Measuring spatial dependence in spatially continuous data</a></li>
<li class="chapter" data-level="35.6" data-path="spatially-continuous-data-iii.html"><a href="spatially-continuous-data-iii.html#variographic-analyisis"><i class="fa fa-check"></i><b>35.6</b> Variographic analyisis</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="activity-17-spatially-continuous-data-iii.html"><a href="activity-17-spatially-continuous-data-iii.html"><i class="fa fa-check"></i><b>36</b> Activity 17: Spatially Continuous Data III</a>
<ul>
<li class="chapter" data-level="36.1" data-path="activity-17-spatially-continuous-data-iii.html"><a href="activity-17-spatially-continuous-data-iii.html#practice-questions-14"><i class="fa fa-check"></i><b>36.1</b> Practice questions</a></li>
<li class="chapter" data-level="36.2" data-path="activity-17-spatially-continuous-data-iii.html"><a href="activity-17-spatially-continuous-data-iii.html#learning-objectives-35"><i class="fa fa-check"></i><b>36.2</b> Learning objectives</a></li>
<li class="chapter" data-level="36.3" data-path="activity-17-spatially-continuous-data-iii.html"><a href="activity-17-spatially-continuous-data-iii.html#suggested-reading-16"><i class="fa fa-check"></i><b>36.3</b> Suggested reading</a></li>
<li class="chapter" data-level="36.4" data-path="activity-17-spatially-continuous-data-iii.html"><a href="activity-17-spatially-continuous-data-iii.html#preliminaries-34"><i class="fa fa-check"></i><b>36.4</b> Preliminaries</a></li>
<li class="chapter" data-level="36.5" data-path="activity-17-spatially-continuous-data-iii.html"><a href="activity-17-spatially-continuous-data-iii.html#activity-16"><i class="fa fa-check"></i><b>36.5</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="spatially-continuous-data-iv.html"><a href="spatially-continuous-data-iv.html"><i class="fa fa-check"></i><b>37</b> Spatially Continuous Data IV</a>
<ul>
<li class="chapter" data-level="37.1" data-path="spatially-continuous-data-iv.html"><a href="spatially-continuous-data-iv.html#learning-objectives-36"><i class="fa fa-check"></i><b>37.1</b> Learning objectives</a></li>
<li class="chapter" data-level="37.2" data-path="spatially-continuous-data-iv.html"><a href="spatially-continuous-data-iv.html#suggested-reading-17"><i class="fa fa-check"></i><b>37.2</b> Suggested reading</a></li>
<li class="chapter" data-level="37.3" data-path="spatially-continuous-data-iv.html"><a href="spatially-continuous-data-iv.html#preliminaries-35"><i class="fa fa-check"></i><b>37.3</b> Preliminaries</a></li>
<li class="chapter" data-level="37.4" data-path="spatially-continuous-data-iv.html"><a href="spatially-continuous-data-iv.html#using-residual-spatial-pattern-to-estimate-prediction-errors"><i class="fa fa-check"></i><b>37.4</b> Using residual spatial pattern to estimate prediction errors</a></li>
<li class="chapter" data-level="37.5" data-path="spatially-continuous-data-iv.html"><a href="spatially-continuous-data-iv.html#kriging-a-method-for-optimal-prediction."><i class="fa fa-check"></i><b>37.5</b> Kriging: a method for optimal prediction.</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="activity-18-spatially-continuous-data-iv.html"><a href="activity-18-spatially-continuous-data-iv.html"><i class="fa fa-check"></i><b>38</b> Activity 18: Spatially Continuous Data IV</a>
<ul>
<li class="chapter" data-level="38.1" data-path="activity-18-spatially-continuous-data-iv.html"><a href="activity-18-spatially-continuous-data-iv.html#practice-questions-15"><i class="fa fa-check"></i><b>38.1</b> Practice questions</a></li>
<li class="chapter" data-level="38.2" data-path="activity-18-spatially-continuous-data-iv.html"><a href="activity-18-spatially-continuous-data-iv.html#learning-objectives-37"><i class="fa fa-check"></i><b>38.2</b> Learning objectives</a></li>
<li class="chapter" data-level="38.3" data-path="activity-18-spatially-continuous-data-iv.html"><a href="activity-18-spatially-continuous-data-iv.html#suggested-reading-18"><i class="fa fa-check"></i><b>38.3</b> Suggested reading</a></li>
<li class="chapter" data-level="38.4" data-path="activity-18-spatially-continuous-data-iv.html"><a href="activity-18-spatially-continuous-data-iv.html#preliminaries-36"><i class="fa fa-check"></i><b>38.4</b> Preliminaries</a></li>
<li class="chapter" data-level="38.5" data-path="activity-18-spatially-continuous-data-iv.html"><a href="activity-18-spatially-continuous-data-iv.html#activity-17"><i class="fa fa-check"></i><b>38.5</b> Activity</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Spatial Data Analysis and Statistics: A Course in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="point-pattern-analysis-iii" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> Point Pattern Analysis III<a href="point-pattern-analysis-iii.html#point-pattern-analysis-iii" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>NOTE</em>: The source files for this book are available with companion package <a href="https://paezha.github.io/isdas/">{isdas}</a>. The source files are in Rmarkdown format and packed as templates. These files allow you execute code within the notebook, so that you can work interactively with the notes.</p>
<p>In the last practice/session your learning objectives included:</p>
<ol style="list-style-type: decimal">
<li>The intuition behind the quadrat-based test of independence.</li>
<li>The concept of kernel density.</li>
<li>The limitations of density-based analysis</li>
<li>More ways to work with <code>ppp</code> objects.</li>
</ol>
<p>If you wish to work interactively with this chapter you will need the following:</p>
<ul>
<li><p>An R markdown notebook version of this document (the source file).</p></li>
<li><p>A package called <code>isdas</code>.</p></li>
</ul>
<div id="learning-objectives-12" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Learning Objectives<a href="point-pattern-analysis-iii.html#learning-objectives-12" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this practice, you will learn:</p>
<ol style="list-style-type: decimal">
<li>About clustered and dispersed (or regular) patterns.</li>
<li>The concept of nearest neighbors.</li>
<li>About distance-based methods for point pattern analysis.</li>
<li>About the G-function for the analysis of event-to-event nearest neighbor distances.</li>
</ol>
</div>
<div id="suggested-readings-5" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Suggested Readings<a href="point-pattern-analysis-iii.html#suggested-readings-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Bailey TC and Gatrell AC <span class="citation">(<a href="#ref-Bailey1995">1995</a>)</span> Interactive Spatial Data Analysis, Chapter 3. Longman: Essex.</li>
<li>Baddeley A, Rubak E, Turner R <span class="citation">(<a href="#ref-Baddeley2015">2016</a>)</span> Spatial Point Pattern: Methodology and Applications with R, Chapter 8. CRC: Boca Raton.</li>
<li>Bivand RS, Pebesma E, Gomez-Rubio V <span class="citation">(<a href="#ref-Bivand2008">2008</a>)</span> Applied Spatial Data Analysis with R, Chapter 7. Springer: New York.</li>
<li>Brunsdon C and Comber L <span class="citation">(<a href="#ref-Brunsdon2015R">2015</a>)</span> An Introduction to R for Spatial Analysis and Mapping, Chapter 6, 6.1 - 6.6. Sage: Los Angeles.</li>
<li>O’Sullivan D and Unwin D <span class="citation">(<a href="#ref-Osullivan2010">2010</a>)</span> Geographic Information Analysis, 2nd Edition, Chapter 5. John Wiley &amp; Sons: New Jersey.</li>
</ul>
</div>
<div id="preliminaries-11" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Preliminaries<a href="point-pattern-analysis-iii.html#preliminaries-11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As usual, it is good practice to begin with a clean session to make sure that you do not have extraneous items there when you begin your work. The best practice is to restart the <code>R</code> session, which can be accomplished for example with <code>command/ctrl + shift + F10</code>. An alternative to <em>only</em> purge user-created objects from memory is to use the <code>R</code> command <code>rm</code> (for “remove”), followed by a list of items to be removed. To clear the workspace from <em>all</em> objects, do the following:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="point-pattern-analysis-iii.html#cb286-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>Note that <code>ls()</code> lists all objects currently on the workspace.</p>
<p>Load the libraries you will use in this activity:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="point-pattern-analysis-iii.html#cb287-1" tabindex="-1"></a><span class="fu">library</span>(isdas) <span class="co"># Companion Package for Book An Introduction to Spatial Data Analysis and Statistics</span></span>
<span id="cb287-2"><a href="point-pattern-analysis-iii.html#cb287-2" tabindex="-1"></a><span class="fu">library</span>(spatstat) <span class="co"># Spatial Point Pattern Analysis, Model-Fitting, Simulation, Tests</span></span>
<span id="cb287-3"><a href="point-pattern-analysis-iii.html#cb287-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Easily Install and Load the &#39;Tidyverse&#39;</span></span></code></pre></div>
<p>Load the dataset that you will use for this practice:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="point-pattern-analysis-iii.html#cb288-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;pp0_df&quot;</span>)</span></code></pre></div>
<p>Examine the contents of the data frame you just loaded:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="point-pattern-analysis-iii.html#cb289-1" tabindex="-1"></a><span class="fu">summary</span>(pp0_df)</span></code></pre></div>
<pre><code>##        x                y                 marks   
##  Min.   :0.0456   Min.   :0.03409   Pattern 1:36  
##  1st Qu.:0.2251   1st Qu.:0.22963   Pattern 2:36  
##  Median :0.4282   Median :0.43363                 
##  Mean   :0.4916   Mean   :0.47952                 
##  3rd Qu.:0.7812   3rd Qu.:0.77562                 
##  Max.   :0.9564   Max.   :0.94492</code></pre>
<p>As you can see, this data frame includes a set of coordinates for two point patterns, labeled “Pattern 1” and “Pattern 2”, each of which consists of <span class="math inline">\(n=36\)</span> events. The range of the coordinates (between 0 and 1) suggests a window as follows:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="point-pattern-analysis-iii.html#cb291-1" tabindex="-1"></a><span class="co"># Remember, `owin()` is used to create a window to frame </span></span>
<span id="cb291-2"><a href="point-pattern-analysis-iii.html#cb291-2" tabindex="-1"></a><span class="co"># a point pattern in the package `spatstat`</span></span>
<span id="cb291-3"><a href="point-pattern-analysis-iii.html#cb291-3" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), </span>
<span id="cb291-4"><a href="point-pattern-analysis-iii.html#cb291-4" tabindex="-1"></a>          <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>This creates an <code>owin</code> object that defines a region in the unit square.</p>
<p>Given window object <code>W</code>, it is possible to transform the dataframe into a <code>ppp</code> object:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="point-pattern-analysis-iii.html#cb292-1" tabindex="-1"></a><span class="co"># Remember, `as.ppp()` will take a foreign object (foreign </span></span>
<span id="cb292-2"><a href="point-pattern-analysis-iii.html#cb292-2" tabindex="-1"></a><span class="co"># to `spatstat`) and convert it into a `ppp` object</span></span>
<span id="cb292-3"><a href="point-pattern-analysis-iii.html#cb292-3" tabindex="-1"></a>pp0.ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(pp0_df, </span>
<span id="cb292-4"><a href="point-pattern-analysis-iii.html#cb292-4" tabindex="-1"></a>                  <span class="at">W =</span> W)</span></code></pre></div>
<p>If you need a refresher on how to create <code>ppp</code> objects see Chapter <a href="point-pattern-analysis-i.html#point-pattern-analysis-i">9</a></p>
</div>
<div id="motivation" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Motivation<a href="point-pattern-analysis-iii.html#motivation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quadrats and kernel density are examples of density-based analysis. These techniques are useful to help you understand variations in the distribution of events at a relatively large scale, but as previously discussed, may sometimes be less informative by not taking into account <em>small scale</em> variations in the locations of the events.</p>
<p>For this reason, the following two patterns, despite being very different, give identical number of counts per quadrat:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="point-pattern-analysis-iii.html#cb293-1" tabindex="-1"></a><span class="co"># The `split()` function is used to divide data in the vector </span></span>
<span id="cb293-2"><a href="point-pattern-analysis-iii.html#cb293-2" tabindex="-1"></a><span class="co"># into groups using a categorical variable; in this case, the </span></span>
<span id="cb293-3"><a href="point-pattern-analysis-iii.html#cb293-3" tabindex="-1"></a><span class="co"># `ppp` object includes only the coordinates and a variable that </span></span>
<span id="cb293-4"><a href="point-pattern-analysis-iii.html#cb293-4" tabindex="-1"></a><span class="co"># identifies the coordinates as belonging to &quot;Pattern 1&quot; or </span></span>
<span id="cb293-5"><a href="point-pattern-analysis-iii.html#cb293-5" tabindex="-1"></a><span class="co"># &quot;Pattern 2&quot;. For this reason, the split is accomplished according </span></span>
<span id="cb293-6"><a href="point-pattern-analysis-iii.html#cb293-6" tabindex="-1"></a><span class="co"># to this variable</span></span>
<span id="cb293-7"><a href="point-pattern-analysis-iii.html#cb293-7" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">split</span>(pp0.ppp))</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/ch13-plot-pp0-1.png" width="672" /></p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="point-pattern-analysis-iii.html#cb294-1" tabindex="-1"></a><span class="co"># Arguments `nx` and `ny` indicate the number of quadrats on the </span></span>
<span id="cb294-2"><a href="point-pattern-analysis-iii.html#cb294-2" tabindex="-1"></a><span class="co"># x and y directions respectively</span></span>
<span id="cb294-3"><a href="point-pattern-analysis-iii.html#cb294-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">quadratcount</span>(<span class="fu">split</span>(pp0.ppp), </span>
<span id="cb294-4"><a href="point-pattern-analysis-iii.html#cb294-4" tabindex="-1"></a>                  <span class="at">nx =</span> <span class="dv">3</span>, </span>
<span id="cb294-5"><a href="point-pattern-analysis-iii.html#cb294-5" tabindex="-1"></a>                  <span class="at">ny =</span> <span class="dv">3</span>))</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/ch13-plot-quadrat-count-pp0-1.png" width="672" /></p>
<p>The two patterns above have similar <em>density</em>, However, “Pattern 1” displays <em>clustering</em>, a situation characterized by events generally being in close proximity to others. “Pattern 2”, on the other hand, displays <em>dispersion</em> or <em>regularity</em>, a situation where points tend to be located at similar distances from each other.</p>
<p>With some fiddling of the parameters, quadrats can be coaxed to tease out the variations in density, for instance:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="point-pattern-analysis-iii.html#cb295-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">quadratcount</span>(<span class="fu">split</span>(pp0.ppp), </span>
<span id="cb295-2"><a href="point-pattern-analysis-iii.html#cb295-2" tabindex="-1"></a>                  <span class="at">nx =</span> <span class="dv">9</span>, </span>
<span id="cb295-3"><a href="point-pattern-analysis-iii.html#cb295-3" tabindex="-1"></a>                  <span class="at">ny =</span> <span class="dv">9</span>))</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/ch13-plot-quadrat-count-smaller-quadrats-1.png" width="672" /></p>
<p>As a visualization technique, this gives a better sense of the variations in density. However, as noted previously, the quality of the test of independence deteriorates when there are many quadrats with small counts.</p>
<p>As an alternative, kernel density can be used to visualize the smoothed estimate of the density:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="point-pattern-analysis-iii.html#cb296-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(<span class="fu">split</span>(pp0.ppp), </span>
<span id="cb296-2"><a href="point-pattern-analysis-iii.html#cb296-2" tabindex="-1"></a>             <span class="at">sigma =</span> <span class="fl">0.075</span>))</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/ch13-plot-kernel-density-pp0-1.png" width="672" /></p>
<p>However, even when we can visualize the variations in density, we cannot, from the kernel estimate alone, tell if high/low values exceed those of a null landscape - in other words, we lack at the moment a way to test the hypothesis that the density is higher than what would be expected from a null landscape.</p>
<p>In this practice you will learn about a family of techniques that instead of measuring the density, explore patterns by means of distance distributions.</p>
</div>
<div id="nearest-neighbors" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Nearest Neighbors<a href="point-pattern-analysis-iii.html#nearest-neighbors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let us begin by introducing the concept of a nearest neighbor.</p>
<p>The nearest neighbor of a location is the event that is closest to said location given some metric. This metric is usually Euclidean distance on the plane, that is, distance as measured using a straight line between the location and the event. In principle, the metric can be selected according to the characteristics of a dataset: this could be Euclidean distance, great circle distance, or network distance, for events on networks.(see Figure <a href="point-pattern-analysis-iii.html#fig:distance-metrics">13.1</a>).</p>
<div class="figure"><span style="display:block;" id="fig:distance-metrics"></span>
<img src="figures/13-Figure-1.png" alt="\label{fig:distance-metrics}Examples of distance metrics" width="640" />
<p class="caption">
FIGURE 13.1: Examples of distance metrics
</p>
</div>
<p>In this way, the nearest neighbor of <span class="math inline">\(i\)</span> is the event <span class="math inline">\(j\)</span> with the shortest distance <span class="math inline">\(d\)</span> from location <span class="math inline">\(i\)</span>:
<span class="math display">\[
\text{Event }j\text{ is the nearest neighbor of location }i\text{ if: }d_{ij}\le d_{ik} \forall k
\]</span></p>
<p>Ties are relatively rare in most realistic point patterns (even in regular patterns), and may not have a big impact on the analysis.</p>
<p>The package <code>spatstat</code> includes functions to calculate Euclidean distances. Three functions are relevant:</p>
<ul>
<li><p><code>pairdist()</code>: returns the pairwise distance between all pairs of events i and j.</p></li>
<li><p><code>nndist()</code>: returns a vector of distances from events to to their corresponding nearest neighbors; these distances are obtained by sorting the pairwise distances, and selecting the minimum value for each event.</p></li>
<li><p><code>distmap()</code>: returns a pixel image with the distance from each pixel to the nearest event; in effect this is a map of the distances between empty spaces and their corresponding nearest events.</p></li>
</ul>
<p>With these functions we can calculate, for instance, the following distances:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="point-pattern-analysis-iii.html#cb297-1" tabindex="-1"></a><span class="co"># Function `nndist()` will calculate the distance of each </span></span>
<span id="cb297-2"><a href="point-pattern-analysis-iii.html#cb297-2" tabindex="-1"></a><span class="co"># event to its nearest neighbor</span></span>
<span id="cb297-3"><a href="point-pattern-analysis-iii.html#cb297-3" tabindex="-1"></a>pp0_nn1 <span class="ot">&lt;-</span> <span class="fu">nndist</span>(<span class="fu">split</span>(pp0.ppp)<span class="sc">$</span><span class="st">&quot;Pattern 1&quot;</span>)</span></code></pre></div>
<p>The value of <code>nndist()</code> is a vector with <span class="math inline">\(n\)</span> distances, where <span class="math inline">\(n\)</span> is the number of events in the pattern. The first distance in the vector is the distance from the first event in the series to its nearest neighbor, the second is the distance from the second event in the series to its nearest neighbor, and so on.</p>
<p>Let us explore the distribution of these distances by means of a histogram:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="point-pattern-analysis-iii.html#cb298-1" tabindex="-1"></a><span class="co"># Remember, `geom_histogram()` adds a histogram to a `ggplot2` object; </span></span>
<span id="cb298-2"><a href="point-pattern-analysis-iii.html#cb298-2" tabindex="-1"></a><span class="co"># the `binwidth` argument defines the size of each bin for the histogram</span></span>
<span id="cb298-3"><a href="point-pattern-analysis-iii.html#cb298-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">dist =</span> pp0_nn1), </span>
<span id="cb298-4"><a href="point-pattern-analysis-iii.html#cb298-4" tabindex="-1"></a>       <span class="fu">aes</span>(dist)) <span class="sc">+</span> </span>
<span id="cb298-5"><a href="point-pattern-analysis-iii.html#cb298-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.03</span>)</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/ch13-histogram-distances-1.png" width="672" /></p>
<p>Notice how most events (20 out of 36) have a nearest neighbor at a relatively short distance (&lt;0.05). What does this mean?</p>
<p>Compare to the distribution of distances in “Pattern 2” of <code>pp0.ppp</code>:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="point-pattern-analysis-iii.html#cb299-1" tabindex="-1"></a><span class="co"># Calculate the distances to nearest neighbors in the second point</span></span>
<span id="cb299-2"><a href="point-pattern-analysis-iii.html#cb299-2" tabindex="-1"></a><span class="co"># pattern, i.e., &quot;Pattern 2&quot;</span></span>
<span id="cb299-3"><a href="point-pattern-analysis-iii.html#cb299-3" tabindex="-1"></a>pp0_nn2 <span class="ot">&lt;-</span> <span class="fu">nndist</span>(<span class="fu">split</span>(pp0.ppp)<span class="sc">$</span><span class="st">&quot;Pattern 2&quot;</span>)</span>
<span id="cb299-4"><a href="point-pattern-analysis-iii.html#cb299-4" tabindex="-1"></a></span>
<span id="cb299-5"><a href="point-pattern-analysis-iii.html#cb299-5" tabindex="-1"></a><span class="co"># Create a histogram to explore the distribution of values of </span></span>
<span id="cb299-6"><a href="point-pattern-analysis-iii.html#cb299-6" tabindex="-1"></a><span class="co"># distances to nearest neighbors</span></span>
<span id="cb299-7"><a href="point-pattern-analysis-iii.html#cb299-7" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">dist =</span> pp0_nn2), </span>
<span id="cb299-8"><a href="point-pattern-analysis-iii.html#cb299-8" tabindex="-1"></a>       <span class="fu">aes</span>(dist)) <span class="sc">+</span> </span>
<span id="cb299-9"><a href="point-pattern-analysis-iii.html#cb299-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.03</span>)</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/ch13-histogram-distances-Pattern-2-1.png" width="672" /></p>
<p>In this case, most events (more than 30 out of 36) have a nearest neighbor at a distance of approximately 0.15. What does this mean?</p>
<p>The two histograms above are interesting in that they reveal, for “Point Pattern 1” that most events are only a short distance away from another event (indicative of clustering), whereas for “Point Pattern 2” the suggestion is that almost all events have a nearest neighbor at a distance that is constant (indicative of regularity). However, the histograms do not convey more spatial information. Another useful tool to explore the distribution of distances to nearest neighbors is a <em>Stienen diagram</em>. A Stienen diagram is essentially a proportional symbol plot of the events. The sizes of symbols are proportional to the distance to their nearest neighbor. For example, for “Pattern 1” in <code>pp0.ppp</code> (Notice the use of %mark% to add an attribute to the <code>ppp</code> object; the attribute is the distance to the nearest neighbor):</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="point-pattern-analysis-iii.html#cb300-1" tabindex="-1"></a><span class="co"># The function %mark% is used to add a variable (a &quot;mark&quot;) to a `ppp` object. In this example, the variable we are adding to &quot;Pattern 1&quot; is the distance from the event to its nearest neighbor, as calculated above</span></span>
<span id="cb300-2"><a href="point-pattern-analysis-iii.html#cb300-2" tabindex="-1"></a><span class="fu">split</span>(pp0.ppp)<span class="sc">$</span><span class="st">&quot;Pattern 1&quot;</span> <span class="sc">%mark%</span> (pp0_nn1) <span class="sc">%&gt;%</span></span>
<span id="cb300-3"><a href="point-pattern-analysis-iii.html#cb300-3" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">markscale =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">&quot;Stienen diagram&quot;</span>)</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>In this diagram, the largest circle is not very large: even events that are relatively isolated are not a long distance away from their nearest neighbor. This fits the definition of clustering as a situation where events tend to be relatively close to each other.</p>
<p>Compare to the Stienen diagram of “Pattern 2”:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="point-pattern-analysis-iii.html#cb301-1" tabindex="-1"></a><span class="fu">split</span>(pp0.ppp)<span class="sc">$</span><span class="st">&quot;Pattern 2&quot;</span> <span class="sc">%mark%</span> (pp0_nn2) <span class="sc">%&gt;%</span></span>
<span id="cb301-2"><a href="point-pattern-analysis-iii.html#cb301-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">markscale =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">&quot;Stienen diagram&quot;</span>)</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Notice how all circles are very similar in size: this fits the definition of dispersion, where events are more or less equally distant from their nearest neighbors.</p>
<p>What would these diagrams look for a null landscape? We can use the function <code>runifpoint</code> from the <code>spatstat</code> package to generate a null landscape:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="point-pattern-analysis-iii.html#cb302-1" tabindex="-1"></a><span class="co"># `runifpoint()` is a function to generate random coordinates based on the uniform random distribution function. The argument tells the function to create n = 36 random coordinates for our null landscape; this null landscape is contained in the window `W`, same as our previous point patterns  </span></span>
<span id="cb302-2"><a href="point-pattern-analysis-iii.html#cb302-2" tabindex="-1"></a>rand_ppp <span class="ot">&lt;-</span> <span class="fu">runifpoint</span>(<span class="at">n =</span> <span class="dv">36</span>, <span class="at">win =</span> W)</span></code></pre></div>
<p>If we plot the Stienen diagram for this point pattern:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="point-pattern-analysis-iii.html#cb303-1" tabindex="-1"></a><span class="co"># Calculate the distances to nearest neighbors for the null landscape</span></span>
<span id="cb303-2"><a href="point-pattern-analysis-iii.html#cb303-2" tabindex="-1"></a>rand_nn <span class="ot">&lt;-</span> <span class="fu">nndist</span>(rand_ppp)</span>
<span id="cb303-3"><a href="point-pattern-analysis-iii.html#cb303-3" tabindex="-1"></a></span>
<span id="cb303-4"><a href="point-pattern-analysis-iii.html#cb303-4" tabindex="-1"></a><span class="co"># Add the distances as calculated above to the point pattern using %mark% and plot the Stienen diagram</span></span>
<span id="cb303-5"><a href="point-pattern-analysis-iii.html#cb303-5" tabindex="-1"></a>rand_ppp <span class="sc">%mark%</span> (rand_nn) <span class="sc">%&gt;%</span></span>
<span id="cb303-6"><a href="point-pattern-analysis-iii.html#cb303-6" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">markscale =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="st">&quot;Stienen diagram&quot;</span>)</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>In a null landscape, the distribution of the size of the symbols would tend to be random!</p>
<p>The concept of nearest neighbors is useful to define a family of techniques that are based on the distribution of distances to nearest neighbors. Three such techniques are introduced here.</p>
</div>
<div id="g-function" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> <span class="math inline">\(G\)</span>-function<a href="point-pattern-analysis-iii.html#g-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As you have seen above, the distribution of distances to nearest neighbors presents distinctive characteristics for different types of patterns.</p>
<p>What is needed is a convenient way to summarize the distribution of distances to nearest neighbors. A way to do so is by means of a plot of the <em>cumulative distribution function</em>. A cumulative distribution is simply the proportion of events that have a nearest neighbor at a distance less than some value <span class="math inline">\(x\)</span>. When the value of <span class="math inline">\(x\)</span> is very small, no events have a nearest neighbor at <span class="math inline">\(d_{ij}&lt;x\)</span>. When <span class="math inline">\(x\)</span> is very large all events have a nearest neighbor at <span class="math inline">\(d_{ij}&lt;x\)</span>. The cumulative distribution thus depends on the value of <span class="math inline">\(x\)</span>.</p>
<p>Imagine for instance the following hypothetical distribution of distances of ten events to their nearest neighbors (the first event’s nearest neighbor is at a distance of 1, the second event’s nearest neighbor is at 2, the third’s at 0.5, and so on):</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="point-pattern-analysis-iii.html#cb304-1" tabindex="-1"></a>nnd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">0.5</span>, <span class="fl">2.5</span>, <span class="fl">1.7</span>, <span class="dv">4</span>, <span class="fl">3.5</span>, <span class="fl">1.2</span>, <span class="fl">2.3</span>, <span class="fl">2.8</span>)</span></code></pre></div>
<p>When <span class="math inline">\(x = 0\)</span>, zero events have a nearest neighbor at that distance or less. Two events have nearest neighbors at distances <span class="math inline">\(d_{ij} &lt;= 1\)</span>. Five events have a nearest neighbor at distances <span class="math inline">\(d_{ij} &lt;= 2\)</span>. Eight events have a nearest neighbor at dist <span class="math inline">\(d_{ij} &lt;= 3\)</span>. And all events have a nearest neighbor at distances <span class="math inline">\(d_{ij} &lt;= 4\)</span>.</p>
<p>We can plot these numbers of events as a proportion:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="point-pattern-analysis-iii.html#cb305-1" tabindex="-1"></a><span class="co"># Create a data frame for plotting the proportion of events with a nearest neighbor at a distance $d_ij &lt;= x$</span></span>
<span id="cb305-2"><a href="point-pattern-analysis-iii.html#cb305-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="at">proportion =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span><span class="sc">/</span><span class="dv">10</span>, <span class="dv">5</span><span class="sc">/</span><span class="dv">10</span>, <span class="dv">8</span><span class="sc">/</span><span class="dv">10</span>, <span class="dv">10</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb305-3"><a href="point-pattern-analysis-iii.html#cb305-3" tabindex="-1"></a></span>
<span id="cb305-4"><a href="point-pattern-analysis-iii.html#cb305-4" tabindex="-1"></a><span class="co"># `geom_line()` creates lines that connect the coordinates of the data inputs</span></span>
<span id="cb305-5"><a href="point-pattern-analysis-iii.html#cb305-5" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb305-6"><a href="point-pattern-analysis-iii.html#cb305-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> proportion))</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The cumulative distribution function of distances from event to nearest neighbor is called a <em><span class="math inline">\(G\)</span>-function</em>.</p>
<p>This function is defined as follows, with <span class="math inline">\(d_{ik}\)</span> as the distance from the event at i to its nearest neighbor:
<span class="math display">\[
\hat{G}(x)=\frac{(d_{ik}\le x, \forall i)}{n}
\]</span></p>
<p>This function (with a hat, because it is estimated from the data), can be used to explore spatial point patterns. When doing so, it is useful to know that the theoretical value of <span class="math inline">\(G\)</span> (assuming a null landscape generated by a <em>Poisson</em> distribution) is as follows:
<span class="math display">\[
G_{pois}(x) = 1 - exp(-\lambda \pi x^2).
\]</span></p>
<p>When the empirical <span class="math inline">\(\hat{G}(x)\)</span> is greater than the theoretical function, this suggests that the events tend to be <em>closer</em> than expected, compared to the null landscape. This would be indicative of a pattern of events that form clusters. On the contrary, when the empirical function is less than the theoretical function, this would suggest that the events tend to be <em>further</em> away from each other than expected, compared to the null landscape. This would be indicative of a <em>dispersed</em> or <em>regular</em> pattern.</p>
<p>The <span class="math inline">\(G\)</span>-function is implemented in <code>spatstat</code> as <code>Gest</code> (for <span class="math inline">\(G\)</span> estimated):</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="point-pattern-analysis-iii.html#cb306-1" tabindex="-1"></a><span class="co"># Use split to calculate the G-function only for &quot;Pattern 1&quot;</span></span>
<span id="cb306-2"><a href="point-pattern-analysis-iii.html#cb306-2" tabindex="-1"></a>g_pattern1 <span class="ot">&lt;-</span> <span class="fu">Gest</span>(<span class="fu">split</span>(pp0.ppp)<span class="sc">$</span><span class="st">&quot;Pattern 1&quot;</span>, <span class="at">correction =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p>(For the moment ignore the argument “correction”; we will discuss corrections later on.)</p>
<p>The <code>plot()</code> function can be used to visualize the estimated G (with r = x):</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="point-pattern-analysis-iii.html#cb307-1" tabindex="-1"></a><span class="fu">plot</span>(g_pattern1)</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>In the plot above, the empirical function is the solid black line, and the theoretical is the dashed red line.</p>
<p>If you examine the empirical function, you will see that about 50% of events have a nearest neighbor at a distance of less than approximately 0.04. In the null landscape (theoretical function), in contrast, only about 16% of events have a nearest neighbor at less than 0.04:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="point-pattern-analysis-iii.html#cb308-1" tabindex="-1"></a><span class="fu">plot</span>(g_pattern1)</span>
<span id="cb308-2"><a href="point-pattern-analysis-iii.html#cb308-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.04</span>, <span class="fl">0.04</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.5</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb308-3"><a href="point-pattern-analysis-iii.html#cb308-3" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.04</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>)</span>
<span id="cb308-4"><a href="point-pattern-analysis-iii.html#cb308-4" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.04</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">0.16</span>, <span class="fl">0.16</span>), <span class="at">lty =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Notice that the empirical function is above the theoretical function. This suggests is that in the actual landscape events tend to be much closer to other events in comparison the null landscape, and would therefore be suggestive of clustering.</p>
<p>Compare to “Pattern 2”:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="point-pattern-analysis-iii.html#cb309-1" tabindex="-1"></a>g_pattern2 <span class="ot">&lt;-</span> <span class="fu">Gest</span>(<span class="fu">split</span>(pp0.ppp)<span class="sc">$</span><span class="st">&quot;Pattern 2&quot;</span>, <span class="at">correction =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb309-2"><a href="point-pattern-analysis-iii.html#cb309-2" tabindex="-1"></a><span class="fu">plot</span>(g_pattern2)</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Now the empirical function is below the one for the null landscape. Notice too that all events have a nearest neighbor in a limited range of distances, between 0.14 and 0.18. This is indicative of a dispersed, or regular pattern.</p>
<p>And the random pattern that you created before:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="point-pattern-analysis-iii.html#cb310-1" tabindex="-1"></a>g_pattern_rnd <span class="ot">&lt;-</span> <span class="fu">Gest</span>(rand_ppp, <span class="at">correction =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb310-2"><a href="point-pattern-analysis-iii.html#cb310-2" tabindex="-1"></a><span class="fu">plot</span>(g_pattern_rnd)</span></code></pre></div>
<p><img src="13-Point-Pattern-Analysis-III_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>In this case, the empirical function more closely resembles the theoretical function for the null landscape. This suggests a random pattern.</p>
<p>By considering the distribution of distances to nearest neighbors, you can generate additional information on a point pattern to complement the density-based analysis of the preceding chapters.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Baddeley2015" class="csl-entry">
Baddeley, Adrian, Ege Rubak, and Rolf Turner. 2016. <em>Spatial Point Patterns: Methodology and Applications with r</em>. Book. Chapman; Hall/CRC.
</div>
<div id="ref-Bailey1995" class="csl-entry">
Bailey, T. C., and A. C. Gatrell. 1995. <em>Interactive Spatial Data Analysis</em>. Book. Essex: Addison Wesley Longman.
</div>
<div id="ref-Bivand2008" class="csl-entry">
Bivand, R. S., E. J. Pebesma, and V. Gómez-Rubio. 2008. <em>Applied Spatial Data Analysis with r</em>. Book. New York: Springer Science+Business Media.
</div>
<div id="ref-Brunsdon2015R" class="csl-entry">
Brunsdon, Chris, and Lex Comber. 2015. <em>An Introduction to r for Spatial Analysis and Mapping</em>. Book. Sage.
</div>
<div id="ref-Osullivan2010" class="csl-entry">
O’Sullivan, David, and David Unwin. 2010. <em>Geographic Information Analysis</em>. Book. 2nd. Edition. Hoboken, New Jersey: John Wiley &amp; Sons.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="activity-5-point-pattern-analysis-ii.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="activity-6-point-pattern-analysis-iii.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": true,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
